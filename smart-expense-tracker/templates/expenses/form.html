{% extends "base.html" %}
{% block title %}{{ action }} Expense – ExpenseIQ{% endblock %}
{% block page_title %}{{ action }} Expense{% endblock %}

{% block content %}
<div class="form-page-wrapper">
  <div class="card">
    <div class="card-header">
      <h3>{% if action == 'Add' %}➕{% else %}✏️{% endif %} {{ action }} Expense</h3>
      <a href="{{ url_for('expenses.list_expenses') }}" class="btn btn-outline btn-sm">← Back to List</a>
    </div>
    <div class="card-body">
      <form method="POST"
        action="{% if action == 'Add' %}{{ url_for('expenses.add_expense') }}{% else %}{{ url_for('expenses.edit_expense', expense_id=expense_id) }}{% endif %}"
        novalidate>
        {{ form.hidden_tag() }}

        <!-- Amount & Category row -->
        <div class="form-row">
          <div class="form-group">
            <label for="amount">Amount (₹)</label>
            <div class="input-prefix">
              <span class="prefix">₹</span>
              {{ form.amount(id="amount",
              class="form-control" + (" is-invalid" if form.amount.errors else ""),
              placeholder="0.00",
              step="0.01",
              min="0.01") }}
            </div>
            {% for error in form.amount.errors %}
            <span class="form-error">{{ error }}</span>
            {% endfor %}
          </div>

          <div class="form-group">
            <label for="category_id">Category</label>
            {{ form.category_id(id="category_id",
            class="form-control" + (" is-invalid" if form.category_id.errors else "")) }}
            {% for error in form.category_id.errors %}
            <span class="form-error">{{ error }}</span>
            {% endfor %}
          </div>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label for="description">Description</label>
          {{ form.description(id="description",
          class="form-control" + (" is-invalid" if form.description.errors else ""),
          placeholder="e.g. Lunch at restaurant, Monthly gym membership…",
          maxlength="255") }}
          {% for error in form.description.errors %}
          <span class="form-error">{{ error }}</span>
          {% endfor %}
        </div>

        <!-- Date -->
        <div class="form-group">
          <label for="date">Date</label>
          {{ form.date(id="date",
          class="form-control" + (" is-invalid" if form.date.errors else "")) }}
          {% for error in form.date.errors %}
          <span class="form-error">{{ error }}</span>
          {% endfor %}
        </div>

        <div class="form-actions">
          <a href="{{ url_for('expenses.list_expenses') }}" class="btn btn-outline">Cancel</a>
          <button type="submit" class="btn btn-primary">
            {% if action == 'Add' %}Save Expense{% else %}Update Expense{% endif %}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}